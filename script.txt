tell application "Mail"	try		delay 2		set theMessages to message 1 of mailbox "INBOX" of account "iCloud" whose subject contains "New sub"		repeat with aMessage in theMessages			tell aMessage				if content contains "John Legend" then					set theContent to source as rich text					set P1 to offset of "Scheduled <a href=" in theContent					set theContent to rich text (P1 + 19) through -1 of theContent					set P2 to offset of "><b>(volunteer now)</b>" in theContent					set theLink to rich text 1 through (P2 - 5) of theContent					tell application "Google Chrome"						activate						open location theLink						delay 2						tell active tab of window 1							execute javascript "document.getElementsByName('ok')[0].click()"						end tell					end tell					tell application "Messages"						set myid to get id of first service						set targetBuddy to buddy "+xxxxxxxxxx" of service id myid						send "John Legend Shift!" to targetBuddy					end tell					display notification "you've been signed up!"				else					set theContent to source as rich text					set P1 to offset of "the following position:" in theContent					set theContent to rich text (P1 + 25) through -1 of theContent					set P2 to offset of "- Scheduled (volunteer now)" in theContent					set theContent to rich text 1 through (P2 - 2) of theContent					tell application "Messages"						set myid to get id of first service						set targetBuddy to buddy "+xxxxxxxxx" of service id myid						send theContent to targetBuddy					end tell					display notification theContent				end if			end tell		end repeat		tell application "Mail"			move theMessages to mailbox "Trash" of account "iCloud"		end tell	on error theError		display dialog theError buttons {"OK"} default button 1		return	end tryend tell